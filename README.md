# <p align="center">**SMIT** </p>
**<p align='center'> Smart Meter Interface Tool </p>**   
<p align='center'> Download and show your power usage </p>


TOC
---

 * [Intention](#intention)
 * [About](#about)
 * [Usage](#usage)
 * [Roadmap](#roadmap)
 * [Testing](#testing)
 * [Issues](#issues)
 * [Documentation](#documentation)
 * [Disclaimer](#disclaimer)
 * [Requirements](#requirements)
 * [Participation Guidlines](#participating-guidlines)
 * [Folderstructure](#folderstructure)
 * [Branches](#branches)
 * [Licence](#licence)
 * [Acknowledgements](#acknowledgements)

## Intention
My main motivations for this application is to 
- strengthen my coding skills and learn how to integrate libraries I have not used so far 
- a playground for different methods to design applications
- showcase for my coding skills and what I'm playing around with.

My goal is to make data which already exists easy acessible. I hope that this data
make users aware of their power consumption patterns. Maybe some of them will then
use this knowledge to **save energy**.

## About
The repository is a static fork of my `in progress` repo. I don't plan to update it regularly however if I implement some cool new features in my private repo I may push them to the public fork. 

I'm **very happy** about user input but won't promise anything about implementing it. 

Additionally web scraping is always messy and if the "Stromnetz Graz" company changes anything at their website I wont promise to fix the scraper. However if I have the personal need for fixing it then I can promise that I will push the fix to the public repository.

## Usage
- In project root folder open `Main.ipynb`.
### Dummy usage
This mode is used for demonstration purposes and testing via pytest.
No "Stromnetz Graz" account is needed.
The Gui and scraping modules are not used.
The dummy data from `./opt/dummy_user` folder is used to setup a application mockup.
This will create a temporary `.dummy` folder in the project directory.
At the beginning of each dummy run the temporary folder will be deleted and newly created.

### Live data usage

<p align="center">
  <img src="./docs/readme/credentials_gui.png" width=35% /> 
  <br>
<br>
<ins><b><i> User Credentials GUI </i></b></ins>
</p>

Running with live data will first open a simple dialog to enter the "Stromnetz Graz" account data.
Username and password are provided by the elictricity provider. Your meter numbers are either found in
the "Netzzugangsvertrag" under "Technische Details - Zählpunkt/Gerät"  from the electricity provider or you can get them online following these steps:

<details>
	<summary>Get Meter Numbers</summary>

1. Open https://webportal.stromnetz-graz.at/login
2. Login
3. Choose "Auswertung"
4. In the "Zählpunktnummer" pull down menu you can see your meter numbers.

<p align="center">
  <img src="./docs/readme/select_meter.png" width=70% /> 
  <br>
<br>
<ins><b><i> "Stromnetz Graz" Data Page </i></b></ins>
</p>
</details>
<br>
Use the last 6 digits from each meter in the credentials dialog.
You can use the 'Save user credentials' option to store your credentials in the `user_data.toml` file.
This file is located in the `./config` folder. See the disclaimer for information on password
storage and handling.
The buttons do exactly what their respective name implies. Implementation details are explained
in the documentation section.


## Roadmap
- GUI with data view
## Testing

## Issues
- No Decline button in GUI
## Documentation
[Modules](https://filedn.eu/liu4e7QL6NoXLInqRT2UAQu/SMIT/index.html)  
[Tests](https://filedn.eu/liu4e7QL6NoXLInqRT2UAQu/tests/index.html)  

## Disclaimer
The password is send in plain text to the login field. This is **not good practice**
but webscraping is per definition somehow messy. If you **save the password** 
it is stored in `program_root/config/user_data.toml` encrypted with the public key
generated by the program and stored in `program_root/config` folder. The keys are included 
in `.gitignore` make shure to **not expose the private key**.
Again this is not good practice but this project is about learning different
tools and coding. 

## Requirements
The virtual environment was created with **Python 3.11** as base.
See `requirements.txt` for all needed dependencies. 

## Participating Guidlines
- Input is appreciated
- We want to keep the project language english, however we understand german and comments, pr's and so on in german are welcome too. 

## Folderstructure
- `root` 
	- --> Project home
- `csv_raw` 
	- --> Folder for webdriver downloads   
	- --> Raw `.csv` files are stored in subdirectories
- `csv_workdir` 
	- --> Python working directory
	- --> Pandas input `.csv` files are stored in subdirectories
- `log` 
	- --> Logfiles
- `opt` 
	- --> **Dummy Configs** are stored in a subdirectory
	- --> Folder for develop files, testfiles... 
- `src` 
	- --> Source code folder
	- --> `SMIT` --> **Modules directory**
- `config` 
	- --> user config files, rsa-keys
- `docs`
	- --> **Pdoc3** generated modules documentation
- `tests`
	- --> **Pytest** source folder
- `.dummy`
	- --> Get's created when application class is instantiated with **dummy option**
	- --> on each instantiation folder gets **deleted and newly created**
- `.tox`
	- --> Data for running tests

## Branches
(Tech stack)
### main
- **Application** - Scrape data - tested on win/linux.
- **Pickle** - Perist date values for automated scraping workflow.
- **Pathlib** - Move files to input directory for python analysis.
- **Application** - Modules as classes, first iteration
- **Pandas** - Create dataframes for further analysis. 
### develop
- **Application** - Modules as classes, pep8 implemented
- **Rsa** - Temporarily store encrypted password in user class.
- **Application** - Import, Module and Folder management in Application class 
- **Tomlkit** - Manage configs in `.toml` files
- **Application** - Dummy option
- **Tkinter** - Gui for user credentials
- **Rsa** - Encrypted password storage
- **Selenium Webdriver** - Scrape data
- **Application** - Automated scrape dates management
- **Pathlib** - Folder structure setup
- **Pytest** - Test Application modules
- **Pdoc** - Generate documentation from docstrings
- **Logger** - Log Application modules

## Licence
This project is under **insert_licence**. 

## Acknowledgements
I would like to thank [mike_landl](https://github.com/mike-landl) for all the 
code contributions, input on best practice, things to think about and generall
guiding how to write clean code! 

---

# <p align='center'> OLD Version </p>

# Stromnetz Graz - Analyse Data from Smartmeter
Automatically scrape and plot the data from 'Stromnetz Graz' web portal.
## Setup
Fill out user credentials in `user_data.py` located in `root` folder.  
In `root` folder create:  
- csv_raw folder
- csv_workdir folder

## Test System
### OS
- Ubuntu 23.04 Standart Distro
- VSCode - direct install, no snap